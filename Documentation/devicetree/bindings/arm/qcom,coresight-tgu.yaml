# SPDX-License-Identifier: GPL-2.0-only OR BSD-2-Clause
# Copyright (c) 2025 Qualcomm Innovation Center, Inc. All rights reserved.
%YAML 1.2
---
$id: http://devicetree.org/schemas/arm/qcom,coresight-tgu.yaml#
$schema: http://devicetree.org/meta-schemas/core.yaml#

title: Trigger Generation Unit - TGU

description: |
  The Trigger Generation Unit (TGU) is a Data Engine which can be utilized
  to sense a plurality of signals and create a trigger into the CTI or
  generate interrupts to processors. The TGU is like the trigger circuit
  of a Logic Analyzer. The corresponding trigger logic can be realized by
  configuring the conditions for each step after sensing the signal.
  Once setup and enabled, it will observe sense inputs and based upon
  the activity of those inputs, even over clock cycles, may detect a
  preprogrammed state/sequence and then produce a trigger or interrupt.

  The primary use case of the TGU is to detect patterns or sequences on a
  given set of signals within some region to indentify the issue in time
  once there is abnormal behavior in the subsystem.

maintainers:
  - Mao Jinlong <quic_jinlmao@quicinc.com>
  - Sam Chai <quic_songchai@quicinc.com>

# Need a custom select here or 'arm,primecell' will match on lots of nodes
select:
  properties:
    compatible:
      contains:
        enum:
          - qcom,coresight-tgu
  required:
    - compatible

properties:
  compatible:
    items:
      - const: qcom,coresight-tgu
      - const: arm,primecell

  reg:
    maxItems: 1

  clocks:
    maxItems: 1

  clock-names:
    items:
      - const: apb_pclk

  in-ports:
    $ref: /schemas/graph.yaml#/properties/ports
    additionalProperties: false

    properties:
      port:
        description:
          The port mechanism here ensures the relationship between TGU and
          TPDM, as TPDM is one of the inputs for TGU. It will allow TGU to
          function as TPDM's helper and enable TGU when the connected
          TPDM is enabled.
        $ref: /schemas/graph.yaml#/properties/port

required:
  - compatible
  - reg
  - clocks
  - clock-names

additionalProperties: false

examples:
  - |
    tgu@10b0e000 {
        compatible = "qcom,coresight-tgu", "arm,primecell";
        reg = <0x10b0e000 0x1000>;

        clocks = <&aoss_qmp>;
        clock-names = "apb_pclk";

        in-ports {
            port {
                tgu_in_tpdm_swao: endpoint{
                    remote-endpoint = <&tpdm_swao_out_tgu>;
                };
            };
        };
    };
...
